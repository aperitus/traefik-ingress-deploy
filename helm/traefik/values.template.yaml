# Traefik minimal values template (schema-compliant for traefik/traefik chart)
# Rendered to /tmp/values.traefik.generated.yaml by the workflow.
#
# Notes:
# - Nexus-only images: set image.registry + image.repository to your Nexus docker repo path.
# - Optional overrides (image.tag, service.spec.loadBalancerIP) are applied via Helm --set in the workflow.
# - Routing mode (Ingress vs Gateway API vs Both) is controlled by the workflow via Helm --set flags.

image:
  # Your internal registry host (e.g. docker-hosted-nexus.logiki.co.uk)
  registry: <TRAEFIK_IMAGE_REGISTRY>
  # Path under registry to Traefik image (e.g. traefik or mirrored path)
  repository: <TRAEFIK_IMAGE_REPOSITORY>

deployment:
  # Use a docker-registry secret created by the workflow in the traefik namespace.
  imagePullSecrets:
    - name: <IMAGE_PULL_SECRET_NAME>

# Internal-only LoadBalancer by default (Azure ILB)
service:
  enabled: true
  type: LoadBalancer
  annotations:
    service.beta.kubernetes.io/azure-load-balancer-internal: "true"

ports:
  web:
    port: 8000
    expose:
      default: true
    exposedPort: 80
    protocol: TCP
  websecure:
    port: 8443
    expose:
      default: true
    exposedPort: 443
    protocol: TCP
  traefik:
    port: 8080
    expose:
      default: false
    exposedPort: 8080
    protocol: TCP
  metrics:
    port: 9100
    expose:
      default: false
    exposedPort: 9100
    protocol: TCP

# Dashboard is enabled in Traefik, but not exposed via IngressRoute by default.
# The workflow can enable it temporarily for dev-only testing.
api:
  dashboard: true
  ingressRoute:
    dashboard:
      enabled: false
      entryPoints:
        - traefik

# Providers default:
# - kubernetesCRD enabled (Traefik CRDs)
# - kubernetesIngress enabled (Kubernetes Ingress)
# - kubernetesGateway disabled (Gateway API)
# The workflow toggles provider enablement based on routing_mode (ingress|gateway|both).
providers:
  kubernetesCRD:
    enabled: true
    allowCrossNamespace: false
  kubernetesIngress:
    enabled: true
  kubernetesGateway:
    enabled: false
